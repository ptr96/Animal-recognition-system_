import numpy as np
import tensorflow as tf

from config import IMG_HEIGHT, IMG_WIDTH
from src.utils.get_data_class_names import get_data_class_names
from src.utils.get_img_from_base64 import get_img_from_base64

base64_string_shark = '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'


print(tf.__version__)

def get_img(path):
     img = tf.keras.utils.load_img(
      path, target_size=(IMG_HEIGHT, IMG_WIDTH)
    )
     return img

def predict_image_class():
  model = tf.keras.models.load_model('models/model.keras')
  class_names = get_data_class_names()

  # img = get_img_from_base64(base64_string_shark)
  img = get_img('data/test_images/tiger2.jpeg')
  
  img_array = tf.keras.utils.img_to_array(img)
  img_array = tf.expand_dims(img_array, 0) # Create a batch

  predictions = model.predict(img_array)
  score = tf.nn.softmax(predictions[0])

  print(
      "This image most likely belongs to {} with a {:.2f} percent confidence."
      .format(class_names[np.argmax(score)], 100 * np.max(score))
)
  
predict_image_class()